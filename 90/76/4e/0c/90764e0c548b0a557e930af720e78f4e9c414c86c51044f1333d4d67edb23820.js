console.log("%c","padding:50px 300px;line-height:120px;background:url('http://5b0988e595225.cdn.sohucs.com/images/20181014/000c8b57362f4391af0d5f48a18ad638.gif') repeat;"),console.log("%c%c网站名称%cISP","line-height:28px;","line-height:28px;padding:4px;background:#222;color:#fff;font-size:16px;margin-right:15px","color:#3fa9f5;line-height:28px;font-size:16px;"),console.log("%c%c网站地址%chttp://47.103.204.220","line-height:28px;","line-height:28px;padding:4px;background:#222;color:#fff;font-size:16px;margin-right:15px","color:#ff9900;line-height:28px;font-size:16px;"),console.log("%c%cBUG反馈QQ：%c827880042(遇到问题尽量自己解决，因为我也不一定会*(￣▽￣)~*)，我的任务就是写BUG","line-height:28px;","line-height:28px;padding:4px;background:#222;color:#fff;font-size:16px;margin-right:15px","color:#008000;line-height:28px;font-size:16px;"),$((function(){layui.use(["layer"],(function(){var layer=layui.layer;function urlEncode(String){return encodeURIComponent(String).replace(/'/g,"%27").replace(/"/g,"%22")}function autoBottom(){$(document.body).height()>$(window).height()&&($("footer").removeClass(" navbar-fixed-bottom"),$("footer").addClass("afterMakeNav"))}function alertQrcode(element){layer.open({type:1,title:!1,closeBtn:2,anim:0,zIndex:5,area:"auto",shadeClose:!0,content:$(element),btn:["长按图片或点我保存"],btnAlign:"c",yes:function(){var url=document.querySelector(element).src,a=document.createElement("a"),event=new MouseEvent("click");a.download="万能收款码-"+document.getElementById("recName").value,a.href=url,a.dispatchEvent(event)}})}function alertInfo(){layer.msg("收款码生成成功，请长按或右击保存",{time:2e3,icon:6})}function callBack(status){"success"==status&&setTimeout(()=>{layer.closeAll(),alertInfo(),alertQrcode("#art-qrcode")},10)}autoBottom(),new Swiper(".swiper-container",{initialSlide:0,effect:"coverflow",grabCursor:!0,centeredSlides:!0,slidesPerView:"auto",loop:!0,mousewheel:!0,coverflowEffect:{rotate:50,stretch:0,depth:100,modifier:1,slideShadows:!0},pagination:{el:".swiper-pagination"}}),$("#qqBtn").on("change",(function(e){hasImage=!1;var imageData=null,file=e.target.files[0],canvas=$("#canvas")[0],context=canvas.getContext("2d");if(file){hasImage=!1,imageData=null;var reader=new FileReader;reader.onload=function(e){var img=new Image;img.crossOrigin="anonymous",img.onload=function(){var width=img.width,height=img.height,actualWidth=Math.min(960,width),actualHeight=height*(actualWidth/width);hasImage=!0,canvas.width=actualWidth,canvas.height=actualHeight,context.drawImage(img,0,0,width,height,0,0,actualWidth,actualHeight),imageData=context.getImageData(0,0,actualWidth,actualHeight)},img.src=e.target.result}}reader.readAsDataURL(file),setTimeout(()=>{var result=(new QRCode.Decoder).decode(imageData.data,imageData.width,imageData.height);result?"-1"==result.data.indexOf("qianbao")?layer.msg("该收款码不是QQ收款码，请上传QQ收款码",{time:3e3,icon:5}):(layer.msg("上传成功",{time:3e3,icon:6}),document.getElementById("qq").value=result.data):function(e,param){analyticCode.getUrl(param,e,(function(url){"error decoding QR Code"==url?layer.confirm("该收款码解码失败，是否前往第三方网站获取收款码链接？",{btn:["立刻前往","朕不想去"]},(function(){window.open("https://jiema.wwei.cn/","_blank").location,layer.closeAll()}),(function(){})):"-1"==url.indexOf("qianbao")?layer.msg("该收款码不是QQ收款码，请上传QQ收款码",{time:3e3,icon:5}):(layer.msg("上传成功",{time:3e3,icon:6}),document.getElementById("qq").value=url)}))}(this,"file-url")},200)})),$("#wechatBtn").on("change",(function(e){hasImage=!1;var imageData=null,file=e.target.files[0],canvas=$("#canvas")[0],context=canvas.getContext("2d");if(file){hasImage=!1,imageData=null;var reader=new FileReader;reader.onload=function(e){var img=new Image;img.crossOrigin="anonymous",img.onload=function(){var width=img.width,height=img.height,actualWidth=Math.min(960,width),actualHeight=height*(actualWidth/width);hasImage=!0,canvas.width=actualWidth,canvas.height=actualHeight,context.drawImage(img,0,0,width,height,0,0,actualWidth,actualHeight),imageData=context.getImageData(0,0,actualWidth,actualHeight)},img.src=e.target.result}}reader.readAsDataURL(file),setTimeout(()=>{var result=(new QRCode.Decoder).decode(imageData.data,imageData.width,imageData.height);result?"-1"==result.data.indexOf("wxp")?layer.msg("该收款码不是微信收款码，请上传微信收款码",{time:3e3,icon:5}):(layer.msg("上传成功",{time:3e3,icon:6}),document.getElementById("wechat").value=result.data):function(e,param){analyticCode.getUrl(param,e,(function(url){"error decoding QR Code"==url?layer.confirm("该收款码解码失败，是否前往第三方网站获取收款码链接？",{btn:["立刻前往","朕不想去"]},(function(){window.open("https://jiema.wwei.cn/","_blank").location,layer.closeAll()}),(function(){})):"-1"==url.indexOf("wxp")?layer.msg("该收款码不是微信收款码，请上传微信收款码",{time:3e3,icon:5}):(layer.msg("上传成功",{time:3e3,icon:6}),document.getElementById("wechat").value=url)}))}(this,"file-url")},200)})),$("#aliBtn").on("change",(function(e){hasImage=!1;var imageData=null,file=e.target.files[0],canvas=$("#canvas")[0],context=canvas.getContext("2d");if(file){hasImage=!1,imageData=null;var reader=new FileReader;reader.onload=function(e){var img=new Image;img.crossOrigin="anonymous",img.onload=function(){var width=img.width,height=img.height,actualWidth=Math.min(960,width),actualHeight=height*(actualWidth/width);hasImage=!0,canvas.width=actualWidth,canvas.height=actualHeight,context.drawImage(img,0,0,width,height,0,0,actualWidth,actualHeight),imageData=context.getImageData(0,0,actualWidth,actualHeight)},img.src=e.target.result}}reader.readAsDataURL(file),setTimeout(()=>{var result=(new QRCode.Decoder).decode(imageData.data,imageData.width,imageData.height);result?"-1"==result.data.indexOf("ALIPAY")&&"-1"==result.data.indexOf("alipay")?layer.msg("该收款码不是支付宝收款码，请上传支付宝收款码",{time:3e3,icon:5}):(layer.msg("上传成功",{time:3e3,icon:6}),document.getElementById("ali").value=result.data):function(e,param){analyticCode.getUrl(param,e,(function(url){"error decoding QR Code"==url?layer.confirm("该收款码解码失败，是否前往第三方网站获取收款码链接？",{btn:["立刻前往","朕不想去"]},(function(){window.open("https://jiema.wwei.cn/","_blank").location,layer.closeAll()}),(function(){})):"-1"==url.indexOf("ALIPAY")&&"-1"==url.indexOf("alipay")?layer.msg("该收款码不是支付宝收款码，请上传支付宝收款码",{time:3e3,icon:5}):(layer.msg("上传成功",{time:3e3,icon:6}),document.getElementById("ali").value=url)}))}(this,"file-url")},200)})),$("#make").click((function(){$("#code").empty();var longUrl=document.location.protocol+"//"+window.location.host+window.location.pathname+"allqr.html?qqUrl="+urlEncode($("#qq").val())+"&wechatUrl="+urlEncode($("#wechat").val())+"&aliUrl="+urlEncode($("#ali").val())+"&qq="+urlEncode($("#qqlogo").val())+"&recname="+encodeURI(encodeURI($("#recName").val()));layer.msg("生成中",{icon:16,shade:.01,time:1e4}),$.ajax({type:"get",url:"long2tiny.php?&url_long="+urlEncode(urlEncode(longUrl)),success:function(tinyurl){layer.closeAll();var nowUrl=document.querySelector(".swiper-slide-active").style.backgroundImage.replace("url(","").replace(")","").replace('"',"").replace('"',""),nowName=$(".swiper-slide-active").attr("mould-name")?$(".swiper-slide-active").attr("mould-name"):nowUrl.split("/").pop().replace(".png",""),dataArt=document.querySelector(".swiper-slide-active").dataset.art;dataArt?function(mouldName,tinyurl){$("#qrcode").empty(),async function(){return await fetch("art-config.json").then(res=>res.json())}().then(res=>{res[mouldName].materials.border="./imgs/bgimgs/"+mouldName+".png";var options={text:tinyurl,width:res[mouldName].imgWidth,height:res[mouldName].imgHeight,codeWidth:res[mouldName].qrWidth,codeHeight:res[mouldName].qrHeight,top:res[mouldName].qrTop,left:res[mouldName].qrLeft,materials:res[mouldName].materials};new QRCodeA(document.getElementById("qrcode"),options,callBack),$("#qrcode").show()})}(dataArt,tinyurl):function(nowUrl,nowName,tinyurl){(async function(){return await fetch("config.json").then(res=>res.json())})().then(res=>{var styleName=nowName,config=res,qrWidth=config[styleName].qrWidth,qrHeight=config[styleName].qrHeight,foreground=config[styleName].foreground,background=config[styleName].background,imgWidth=config[styleName].imgWidth,imgHeight=config[styleName].imgHeight,font=config[styleName].font,fontColor=config[styleName].fontColor,recNameLeft=config[styleName].recNameLeft,recNameTop=config[styleName].recNameTop,qrLeft=config[styleName].qrLeft,qrTop=config[styleName].qrTop;!function(element,qrWidth,qrHeight,tinyurl,foreground,background,imgUrl,imgWidth,imgHeight,font,fontColor,recName,recNameLeft,recNameTop,qrLeft,qrTop){$(element).qrcode({render:"canvas",width:qrWidth,height:qrHeight,text:tinyurl,foreground:foreground,background:background});var canvas=document.getElementById("canvas");canvas.width=imgWidth,canvas.height=imgHeight;var ctx=canvas.getContext("2d"),img=new Image;img.crossOrigin="Anonymous",img.src=imgUrl,img.onload=function(){var bg=ctx.createPattern(img,"no-repeat");ctx.fillStyle=bg,ctx.fillRect(0,0,imgWidth,imgHeight),ctx.textAlign="center",ctx.font=font,ctx.fillStyle=fontColor,recName&&(recNameLeft||(recNameLeft=imgWidth/2),ctx.fillText("扫码向“"+recName+"”付款",recNameLeft,recNameTop));var canvasOld=document.getElementsByTagName("canvas")[0];ctx.drawImage(canvasOld,qrLeft,qrTop);var image=new Image;image.crossOrigin="Anonymous",image.src=canvas.toDataURL("image/png"),$(".form-horizontal img").attr("src",image.src)}}("#code",qrWidth,qrHeight,tinyurl,foreground,background,nowUrl,imgWidth,imgHeight,font,fontColor,document.getElementById("recName").value,recNameLeft,recNameTop,qrLeft,qrTop),autoBottom(),setTimeout((function(){alertQrcode("#endImg"),alertInfo()}),100)})}(nowUrl,nowName,tinyurl)},error:function(jqXHR,textStatus,errorThrown){"error"==textStatus&&layer.msg("收款码生成失败，请联系网站管理员",{time:3e3,icon:5})}})}))}))}));